const {Entity} = require("blockade/entity/entity");
const {Vector2} = require("blockade/vectors");

class Plate extends Entity {
	static object = "plate";

	pressed = false;

	/**
	 * Detect if this Plate is being pressed
	 * @returns {boolean}
	 */
	detect() {
		let block = this.game.getBlock(this.position);
		if (block === undefined) return false;
		if (this.color !== block.color) return false;
		if (this.color !== 0 && block.color !== 0) return false;
		return Vector2.equals(block.velocity, Vector2.zero);
	}

	/**
	 * Update this Plate
	 */
	update() {
		super.update();
		if (this.pressed !== this.detect()) {
			this.pressed = !this.pressed;
			this.changed = true;
		}
		return this.changed;
	}
}

module.exports = {Plate};